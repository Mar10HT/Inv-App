<div class="min-h-screen bg-surface p-6">
  <div class="max-w-[1600px] mx-auto">
    <!-- Welcome Section -->
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-foreground mb-2">
        {{ 'DASHBOARD.WELCOME' | translate }}, {{ userName() }}!
      </h1>
      <p class="text-slate-500 text-lg">
        {{ 'DASHBOARD.SUBTITLE' | translate }}
      </p>
    </div>

    <!-- Loading State -->
    @if (loading()) {
      <div class="flex items-center justify-center py-12">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-[#4d7c6f]"></div>
        <span class="ml-3 text-slate-400">{{ 'COMMON.LOADING' | translate }}...</span>
      </div>
    }

    <!-- Error State -->
    @if (error()) {
      <div class="bg-rose-950/30 border border-rose-900 rounded-xl p-4 mb-6">
        <div class="flex items-center gap-3">
          <mat-icon class="!text-rose-400 !leading-none !block">error</mat-icon>
          <span class="text-rose-400">{{ error() }}</span>
        </div>
      </div>
    }

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <!-- Total Items Card -->
      <div class="bg-surface-variant rounded-xl border border-theme p-6 hover:border-slate-700 transition-all">
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <p class="text-sm font-medium text-slate-500 mb-1">{{ 'DASHBOARD.TOTAL_ITEMS' | translate }}</p>
            <p class="text-3xl font-bold text-foreground">{{ stats()?.totalItems || 0 }}</p>
          </div>
          <div class="bg-surface-elevated p-3 rounded-lg flex items-center justify-center w-12 h-12 flex-shrink-0">
            <mat-icon class="!text-slate-500 !text-2xl !leading-none !block">inventory</mat-icon>
          </div>
        </div>
      </div>

      <!-- In Stock Card -->
      <div class="bg-surface-variant rounded-xl border border-emerald-900/50 p-6 hover:border-emerald-800/50 transition-all">
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <p class="text-sm font-medium text-slate-500 mb-1">{{ 'DASHBOARD.IN_STOCK' | translate }}</p>
            <p class="text-3xl font-bold text-emerald-400">{{ stats()?.inStockItems || 0 }}</p>
          </div>
          <div class="bg-[#2d4a3f] p-3 rounded-lg flex items-center justify-center w-12 h-12 flex-shrink-0">
            <mat-icon class="!text-emerald-700 !text-2xl !leading-none !block">check_circle</mat-icon>
          </div>
        </div>
      </div>

      <!-- Low Stock Card -->
      <div class="bg-surface-variant rounded-xl border border-orange-900/50 p-6 hover:border-orange-800/50 transition-all">
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <p class="text-sm font-medium text-slate-500 mb-1">{{ 'DASHBOARD.LOW_STOCK' | translate }}</p>
            <p class="text-3xl font-bold text-orange-400">{{ stats()?.lowStockItems || 0 }}</p>
          </div>
          <div class="bg-orange-950/50 p-3 rounded-lg flex items-center justify-center w-12 h-12 flex-shrink-0">
            <mat-icon class="!text-orange-700 !text-2xl !leading-none !block">warning</mat-icon>
          </div>
        </div>
      </div>

      <!-- Total Value Card -->
      <div class="bg-surface-variant rounded-xl border border-sky-900/50 p-6 hover:border-sky-800/50 transition-all">
        <div class="flex items-center justify-between">
          <div class="flex-1">
            <p class="text-sm font-medium text-slate-500 mb-1">{{ 'DASHBOARD.TOTAL_VALUE' | translate }}</p>
            <p class="text-3xl font-bold text-sky-400">{{ formatCurrency(stats()?.totalValueUSD || 0) }}</p>
          </div>
          <div class="bg-sky-950/50 p-3 rounded-lg flex items-center justify-center w-12 h-12 flex-shrink-0">
            <mat-icon class="!text-sky-700 !text-2xl !leading-none !block">attach_money</mat-icon>
          </div>
        </div>
      </div>
    </div>

    <!-- Secondary Stats Row -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
      <div class="bg-surface-variant rounded-xl border border-theme p-6">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <p class="text-sm font-medium text-slate-500 mb-1">{{ 'DASHBOARD.TOTAL_USERS' | translate }}</p>
            <p class="text-3xl font-bold text-purple-400">{{ stats()?.totalUsers || 0 }}</p>
          </div>
          <div class="bg-purple-950/50 p-3 rounded-lg flex items-center justify-center w-12 h-12 flex-shrink-0">
            <mat-icon class="!text-purple-500 !text-2xl !leading-none !block">people</mat-icon>
          </div>
        </div>
      </div>
      <div class="bg-surface-variant rounded-xl border border-theme p-6">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <p class="text-sm font-medium text-slate-500 mb-1">{{ 'NAV.WAREHOUSES' | translate }}</p>
            <p class="text-3xl font-bold text-cyan-400">{{ stats()?.totalWarehouses || 0 }}</p>
          </div>
          <div class="bg-cyan-950/50 p-3 rounded-lg flex items-center justify-center w-12 h-12 flex-shrink-0">
            <mat-icon class="!text-cyan-500 !text-2xl !leading-none !block">warehouse</mat-icon>
          </div>
        </div>
      </div>
      <div class="bg-surface-variant rounded-xl border border-theme p-6">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <p class="text-sm font-medium text-slate-500 mb-1">{{ 'NAV.CATEGORIES' | translate }}</p>
            <p class="text-3xl font-bold text-amber-400">{{ stats()?.totalCategories || 0 }}</p>
          </div>
          <div class="bg-amber-950/50 p-3 rounded-lg flex items-center justify-center w-12 h-12 flex-shrink-0">
            <mat-icon class="!text-amber-500 !text-2xl !leading-none !block">category</mat-icon>
          </div>
        </div>
      </div>
      <div class="bg-surface-variant rounded-xl border border-theme p-6">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <p class="text-sm font-medium text-slate-500 mb-1">{{ 'DASHBOARD.OUT_OF_STOCK' | translate }}</p>
            <p class="text-3xl font-bold" style="color: var(--color-status-error)">{{ stats()?.outOfStockItems || 0 }}</p>
          </div>
          <div class="ds-icon-container--error p-3 rounded-lg flex items-center justify-center w-12 h-12 flex-shrink-0">
            <mat-icon class="!text-2xl !leading-none !block" style="color: var(--color-status-error)">block</mat-icon>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts Section (Drag & Drop) -->
    <div
      cdkDropList
      cdkDropListOrientation="horizontal"
      (cdkDropListDropped)="onChartWidgetDrop($event)"
      class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
      @for (widget of chartWidgets(); track widget) {
        <div cdkDrag class="bg-surface-variant rounded-xl border border-theme p-6 cursor-move hover:border-[#3a3a3a] transition-colors">
          <!-- Drag Handle -->
          <div cdkDragHandle class="flex items-center justify-between mb-4">
            @if (widget === 'status') {
              <h3 class="text-lg font-semibold text-foreground">{{ 'COMMON.STATUS' | translate }}</h3>
              <mat-icon class="!text-slate-600 !leading-none !block">donut_large</mat-icon>
            } @else if (widget === 'categories') {
              <h3 class="text-lg font-semibold text-foreground">{{ 'NAV.CATEGORIES' | translate }}</h3>
              <mat-icon class="!text-slate-600 !leading-none !block">category</mat-icon>
            } @else if (widget === 'warehouses') {
              <h3 class="text-lg font-semibold text-foreground">{{ 'NAV.WAREHOUSES' | translate }}</h3>
              <mat-icon class="!text-slate-600 !leading-none !block">warehouse</mat-icon>
            }
          </div>

          <!-- Widget Content -->
          @if (widget === 'status') {
            @if (stats()?.totalItems && statusChartOptions()) {
              <apx-chart
                [series]="statusChartSeries()"
                [chart]="statusChartOptions()!.chart"
                [labels]="statusChartOptions()!.labels"
                [colors]="statusChartOptions()!.colors"
                [legend]="statusChartOptions()!.legend"
                [dataLabels]="statusChartOptions()!.dataLabels"
                [plotOptions]="statusChartOptions()!.plotOptions"
                [responsive]="statusChartOptions()!.responsive">
              </apx-chart>
            } @else {
              <div class="flex flex-col items-center justify-center py-12">
                <mat-icon class="!text-3xl !text-slate-700 mb-2 !leading-none !block">donut_large</mat-icon>
                <p class="text-slate-500 text-sm">{{ 'COMMON.NO_DATA' | translate }}</p>
              </div>
            }
          } @else if (widget === 'categories') {
            @if (categoryStats().length > 0 && categoryChartOptions()) {
              <apx-chart
                [series]="categoryChartSeries()"
                [chart]="categoryChartOptions()!.chart"
                [xaxis]="categoryChartOptions()!.xaxis"
                [yaxis]="categoryChartOptions()!.yaxis"
                [colors]="categoryChartOptions()!.colors"
                [grid]="categoryChartOptions()!.grid"
                [plotOptions]="categoryChartOptions()!.plotOptions"
                [dataLabels]="categoryChartOptions()!.dataLabels"
                [tooltip]="categoryChartOptions()!.tooltip">
              </apx-chart>
            } @else {
              <div class="flex flex-col items-center justify-center py-12">
                <mat-icon class="!text-3xl !text-slate-700 mb-2 !leading-none !block">bar_chart</mat-icon>
                <p class="text-slate-500 text-sm">{{ 'COMMON.NO_DATA' | translate }}</p>
              </div>
            }
          } @else if (widget === 'warehouses') {
            @if (warehouseStats().length > 0 && warehouseChartOptions()) {
              <apx-chart
                [series]="warehouseChartSeries()"
                [chart]="warehouseChartOptions()!.chart"
                [xaxis]="warehouseChartOptions()!.xaxis"
                [yaxis]="warehouseChartOptions()!.yaxis"
                [colors]="warehouseChartOptions()!.colors"
                [grid]="warehouseChartOptions()!.grid"
                [plotOptions]="warehouseChartOptions()!.plotOptions"
                [dataLabels]="warehouseChartOptions()!.dataLabels"
                [tooltip]="warehouseChartOptions()!.tooltip"
                [fill]="warehouseChartOptions()!.fill">
              </apx-chart>
            } @else {
              <div class="flex flex-col items-center justify-center py-12">
                <mat-icon class="!text-3xl !text-slate-700 mb-2 !leading-none !block">bar_chart</mat-icon>
                <p class="text-slate-500 text-sm">{{ 'COMMON.NO_DATA' | translate }}</p>
              </div>
            }
          }

          <!-- Drag Placeholder -->
          <div *cdkDragPlaceholder class="bg-[#2a2a2a] rounded-xl border-2 border-dashed border-[#4d7c6f] h-full min-h-[320px]"></div>
        </div>
      }
    </div>

    <!-- Custom Charts Section -->
    <div class="mb-8">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-foreground">{{ 'DASHBOARD.CUSTOM_CHART.SECTION_TITLE' | translate }}</h3>
        <button
          (click)="openCustomChartDialog()"
          class="flex items-center gap-2 px-4 py-2 bg-[#4d7c6f] text-white rounded-lg hover:bg-[#5d8c7f] transition-colors text-sm font-medium">
          <mat-icon class="!text-lg">add</mat-icon>
          {{ 'DASHBOARD.CUSTOM_CHART.ADD' | translate }}
        </button>
      </div>

      @if (customCharts().length === 0) {
        <div class="bg-surface-variant rounded-xl border border-dashed border-[#3a3a3a] p-8 text-center">
          <mat-icon class="!text-4xl !text-slate-700 mb-3 !leading-none !block mx-auto">add_chart</mat-icon>
          <p class="text-slate-500 text-sm mb-4">{{ 'DASHBOARD.CUSTOM_CHART.EMPTY' | translate }}</p>
          <button
            (click)="openCustomChartDialog()"
            class="text-[#4d7c6f] hover:text-[#5d8c7f] text-sm font-medium transition-colors">
            {{ 'DASHBOARD.CUSTOM_CHART.CREATE_FIRST' | translate }}
          </button>
        </div>
      } @else {
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          @for (chart of customCharts(); track chart.id) {
            <div class="bg-surface-variant rounded-xl border border-theme p-6 hover:border-[#3a3a3a] transition-colors">
              <div class="flex items-center justify-between mb-4">
                <h4 class="text-md font-semibold text-foreground truncate">{{ chart.title }}</h4>
                <div class="flex items-center gap-1">
                  <button
                    (click)="openCustomChartDialog(chart)"
                    class="p-1.5 rounded-lg text-slate-500 hover:text-foreground hover:bg-[#2a2a2a] transition-colors">
                    <mat-icon class="!text-lg">edit</mat-icon>
                  </button>
                  <button
                    (click)="deleteCustomChart(chart)"
                    class="p-1.5 rounded-lg text-slate-500 hover:text-rose-400 hover:bg-rose-950/30 transition-colors">
                    <mat-icon class="!text-lg">delete</mat-icon>
                  </button>
                </div>
              </div>

              @if (!dataReady()) {
                <div class="flex flex-col items-center justify-center py-8">
                  <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-[#4d7c6f] mb-2"></div>
                  <p class="text-slate-500 text-sm">{{ 'COMMON.LOADING' | translate }}...</p>
                </div>
              } @else if (getCustomChartData(chart).series.length > 0 || (getCustomChartData(chart).series[0]?.data?.length > 0)) {
                <apx-chart
                  [series]="getCustomChartData(chart).series"
                  [chart]="getCustomChartOptions(chart).chart"
                  [xaxis]="getCustomChartOptions(chart).xaxis"
                  [yaxis]="getCustomChartOptions(chart).yaxis"
                  [colors]="getCustomChartOptions(chart).colors"
                  [grid]="getCustomChartOptions(chart).grid"
                  [plotOptions]="getCustomChartOptions(chart).plotOptions"
                  [dataLabels]="getCustomChartOptions(chart).dataLabels"
                  [legend]="getCustomChartOptions(chart).legend"
                  [labels]="getCustomChartData(chart).labels"
                  [tooltip]="getCustomChartOptions(chart).tooltip">
                </apx-chart>
              } @else {
                <div class="flex flex-col items-center justify-center py-8">
                  <mat-icon class="!text-3xl !text-slate-700 mb-2 !leading-none !block">bar_chart</mat-icon>
                  <p class="text-slate-500 text-sm">{{ 'COMMON.NO_DATA' | translate }}</p>
                </div>
              }
            </div>
          }
        </div>
      }
    </div>

    <!-- Two Column Layout for Tables (Drag & Drop) -->
    <div
      cdkDropList
      cdkDropListOrientation="horizontal"
      (cdkDropListDropped)="onTableWidgetDrop($event)"
      class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
      @for (widget of tableWidgets(); track widget) {
        <div cdkDrag class="bg-surface-variant border border-theme rounded-xl overflow-hidden cursor-move hover:border-[#3a3a3a] transition-colors">
          <!-- Transactions Widget -->
          @if (widget === 'transactions') {
            <div cdkDragHandle class="px-6 py-4 border-b border-theme flex items-center justify-between">
              <div>
                <h2 class="text-lg font-semibold text-foreground">{{ 'TRANSACTION.TITLE' | translate }}</h2>
                <p class="text-slate-500 text-xs mt-1">{{ 'TRANSACTION.SUBTITLE' | translate }}</p>
              </div>
              <button
                (click)="$event.stopPropagation(); viewAllTransactions()"
                class="text-sm text-sky-400 hover:text-sky-300 transition-colors">
                {{ 'COMMON.VIEW_ALL' | translate }}
              </button>
            </div>

            @if (recentTransactions().length === 0) {
              <div class="flex flex-col items-center justify-center py-12">
                <mat-icon class="!text-4xl !text-slate-700 mb-3 !leading-none !block">receipt_long</mat-icon>
                <p class="text-slate-500 text-sm">{{ 'TRANSACTION.NO_TRANSACTIONS' | translate }}</p>
              </div>
            } @else {
              <div class="divide-y divide-[#242424]">
                @for (tx of recentTransactions(); track trackByTransaction($index, tx)) {
                  <div class="px-6 py-4 hover:bg-[#1e1e1e] transition-colors">
                    <div class="flex items-center gap-4">
                      <div
                        class="w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0"
                        [ngClass]="{
                          'bg-emerald-950/50': tx.type === TransactionType.IN,
                          'bg-rose-950/50': tx.type === TransactionType.OUT,
                          'bg-blue-950/50': tx.type === TransactionType.TRANSFER
                        }">
                        <mat-icon [class]="getTransactionTypeClass(tx.type) + ' !leading-none !block'">
                          {{ getTransactionTypeIcon(tx.type) }}
                        </mat-icon>
                      </div>
                      <div class="flex-1 min-w-0">
                        <p class="text-sm font-medium text-foreground">
                          {{ 'TRANSACTION.TYPES.' + tx.type | translate }}
                        </p>
                        <p class="text-xs text-slate-500">
                          {{ tx.items.length }} {{ 'TRANSACTION.ITEMS_COUNT' | translate }}
                        </p>
                      </div>
                      <div class="text-right">
                        <p class="text-xs text-slate-500">{{ formatDateTime(tx.date) }}</p>
                      </div>
                    </div>
                  </div>
                }
              </div>
            }
          }

          <!-- Low Stock Widget -->
          @if (widget === 'lowStock') {
            <div cdkDragHandle class="px-6 py-4 border-b border-theme flex items-center justify-between">
              <div>
                <h2 class="text-lg font-semibold text-foreground">{{ 'DASHBOARD.LOW_STOCK' | translate }}</h2>
                <p class="text-slate-500 text-xs mt-1">{{ 'DASHBOARD.MANAGE_ITEMS' | translate }}</p>
              </div>
              <button
                (click)="$event.stopPropagation(); viewAllInventory()"
                class="text-sm text-sky-400 hover:text-sky-300 transition-colors">
                {{ 'COMMON.VIEW_ALL' | translate }}
              </button>
            </div>

            @if (lowStockItems().length === 0) {
              <div class="flex flex-col items-center justify-center py-12">
                <mat-icon class="!text-4xl !text-emerald-700 mb-3 !leading-none !block">check_circle</mat-icon>
                <p class="text-slate-500 text-sm">{{ 'COMMON.NO_DATA' | translate }}</p>
              </div>
            } @else {
              <div class="divide-y divide-[#242424] max-h-[500px] overflow-y-auto">
                @for (item of lowStockItems().slice(0, 10); track item.id) {
                  <div
                    (click)="viewItem(item)"
                    class="px-6 py-4 hover:bg-[#1e1e1e] transition-colors cursor-pointer">
                    <div class="flex items-center gap-4">
                      <div class="w-10 h-10 bg-orange-950/50 rounded-lg flex items-center justify-center flex-shrink-0">
                        <mat-icon class="!text-orange-500 !leading-none !block">warning</mat-icon>
                      </div>
                      <div class="flex-1 min-w-0">
                        <p class="text-sm font-medium text-foreground truncate">{{ item.name }}</p>
                        <p class="text-xs text-slate-500">{{ item.category?.name || '-' }}</p>
                      </div>
                      <div class="text-right">
                        <p class="text-lg font-bold text-orange-400">{{ item.quantity }}</p>
                        <p class="text-xs text-slate-500">min: {{ item.minQuantity }}</p>
                      </div>
                    </div>
                  </div>
                }
              </div>
              @if (lowStockItems().length > 10) {
                <div class="px-6 py-3 bg-surface-container border-t border-theme text-center">
                  <p class="text-xs text-slate-500">
                    Showing 10 of {{ lowStockItems().length }} low stock items
                  </p>
                </div>
              }
            }
          }

          <!-- Drag Placeholder -->
          <div *cdkDragPlaceholder class="bg-[#2a2a2a] rounded-xl border-2 border-dashed border-[#4d7c6f] h-full min-h-[300px]"></div>
        </div>
      }
    </div>

    <!-- Recent Items Table -->
    <div class="bg-surface-variant border border-theme rounded-xl overflow-hidden">
      <div class="px-6 py-4 border-b border-theme flex items-center justify-between">
        <div>
          <h2 class="text-xl font-semibold text-foreground">{{ 'DASHBOARD.RECENT_ITEMS' | translate }}</h2>
          <p class="text-slate-500 text-sm mt-1">{{ 'DASHBOARD.MANAGE_ITEMS' | translate }}</p>
        </div>
        <button
          (click)="viewAllInventory()"
          class="text-sm text-sky-400 hover:text-sky-300 transition-colors">
          {{ 'COMMON.VIEW_ALL' | translate }}
        </button>
      </div>

      @if (items().length === 0 && !loading()) {
        <!-- Empty State -->
        <div class="flex flex-col items-center justify-center py-16">
          <mat-icon class="!text-6xl !text-slate-700 mb-4 !leading-none !block">inventory_2</mat-icon>
          <p class="text-slate-500 text-lg mb-2">{{ 'INVENTORY.NO_ITEMS' | translate }}</p>
          <p class="text-slate-600 text-sm mb-6">{{ 'INVENTORY.NO_ITEMS_DESC' | translate }}</p>
          <button
            (click)="addNewItem()"
            class="bg-[#4d7c6f] text-white px-6 py-2 rounded-lg hover:bg-[#5d8c7f] transition-all font-medium">
            {{ 'DASHBOARD.ADD_NEW_ITEM' | translate }}
          </button>
        </div>
      } @else {
        <!-- Desktop Table View -->
        <div class="hidden lg:block overflow-x-auto">
          <table class="w-full">
            <thead>
              <tr class="bg-surface-container">
                <th class="text-left px-6 py-4 text-xs font-medium text-slate-500 uppercase tracking-wider min-w-[300px]">{{ 'DASHBOARD.TABLE.ITEM' | translate }}</th>
                <th class="text-left px-6 py-4 text-xs font-medium text-slate-500 uppercase tracking-wider min-w-[120px]">{{ 'DASHBOARD.TABLE.CATEGORY' | translate }}</th>
                <th class="text-left px-6 py-4 text-xs font-medium text-slate-500 uppercase tracking-wider">{{ 'DASHBOARD.TABLE.QUANTITY' | translate }}</th>
                <th class="text-left px-6 py-4 text-xs font-medium text-slate-500 uppercase tracking-wider">{{ 'DASHBOARD.TABLE.PRICE' | translate }}</th>
                <th class="text-left px-6 py-4 text-xs font-medium text-slate-500 uppercase tracking-wider min-w-[100px]">{{ 'DASHBOARD.TABLE.STATUS' | translate }}</th>
                <th class="text-left px-6 py-4 text-xs font-medium text-slate-500 uppercase tracking-wider">{{ 'DASHBOARD.TABLE.ACTIONS' | translate }}</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-[#1e1e1e]">
              @for (item of items(); track trackByFn($index, item)) {
                <tr
                  (click)="viewItem(item)"
                  class="hover:bg-[#1e1e1e] transition-colors cursor-pointer group">
                  <!-- Item Column -->
                  <td class="px-6 py-4">
                    <div class="flex items-center gap-3">
                      <div class="w-10 h-10 bg-[#2d4a3f] rounded-lg flex items-center justify-center flex-shrink-0">
                        <mat-icon class="!text-[#4d7c6f] !text-lg !leading-none !block">inventory_2</mat-icon>
                      </div>
                      <div class="min-w-0 max-w-[350px]">
                        <p class="font-medium text-foreground truncate">{{ item.name }}</p>
                        <p class="text-sm text-slate-500 truncate">{{ item.description || '-' }}</p>
                      </div>
                    </div>
                  </td>

                  <!-- Category Column -->
                  <td class="px-6 py-4">
                    <span class="text-slate-400">{{ item.category }}</span>
                  </td>

                  <!-- Quantity Column -->
                  <td class="px-6 py-4">
                    <span class="text-foreground font-medium">{{ item.quantity }}</span>
                  </td>

                  <!-- Price Column -->
                  <td class="px-6 py-4">
                    @if (item.price) {
                      <span class="text-foreground font-medium">{{ formatCurrency(item.price, item.currency) }}</span>
                    } @else {
                      <span class="text-slate-600">-</span>
                    }
                  </td>

                  <!-- Status Column -->
                  <td class="px-6 py-4">
                    <span
                      [ngClass]="{
                        'text-emerald-400 bg-emerald-950/50 border border-emerald-900': item.status === 'IN_STOCK',
                        'text-orange-400 bg-orange-950/50 border border-orange-900': item.status === 'LOW_STOCK',
                        'text-rose-400 bg-rose-950/50 border border-rose-900': item.status === 'OUT_OF_STOCK'
                      }"
                      class="px-3 py-1 rounded-md text-xs font-medium inline-block">
                      {{ getStatusKey(item.status) | translate }}
                    </span>
                  </td>

                  <!-- Actions Column -->
                  <td class="px-6 py-4">
                    <div class="flex items-center gap-1">
                      <button
                        type="button"
                        (click)="$event.stopPropagation(); viewItem(item)"
                        class="p-2 rounded-lg text-slate-500 hover:text-sky-400 hover:bg-sky-950/30 transition-colors">
                        <mat-icon class="!text-xl !leading-none !block">visibility</mat-icon>
                      </button>
                      <button
                        type="button"
                        (click)="$event.stopPropagation(); editItem(item)"
                        class="p-2 rounded-lg text-slate-500 hover:text-foreground hover:bg-[#2a2a2a] transition-colors">
                        <mat-icon class="!text-xl !leading-none !block">edit</mat-icon>
                      </button>
                      <button
                        type="button"
                        (click)="$event.stopPropagation(); deleteItem(item)"
                        class="p-2 rounded-lg text-slate-500 hover:text-rose-400 hover:bg-rose-950/30 transition-colors">
                        <mat-icon class="!text-xl !leading-none !block">delete</mat-icon>
                      </button>
                    </div>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>

        <!-- Mobile Card View -->
        <div class="lg:hidden divide-y divide-[#1e1e1e]">
          @for (item of items(); track trackByFn($index, item)) {
            <div class="p-4">
              <div class="flex items-start gap-3 mb-3">
                <div class="w-10 h-10 bg-[#2d4a3f] rounded-lg flex items-center justify-center flex-shrink-0">
                  <mat-icon class="!text-[#4d7c6f] !text-lg !leading-none !block">inventory_2</mat-icon>
                </div>
                <div class="flex-1 min-w-0">
                  <h3 class="font-semibold text-foreground">{{ item.name }}</h3>
                  <p class="text-sm text-slate-500 truncate">{{ item.description || '-' }}</p>
                </div>
              </div>

              <div class="grid grid-cols-2 gap-4 mb-4">
                <div>
                  <p class="text-xs text-slate-500 font-medium uppercase tracking-wide">{{ 'DASHBOARD.TABLE.CATEGORY' | translate }}</p>
                  <p class="text-slate-400 text-sm">{{ item.category }}</p>
                </div>
                <div>
                  <p class="text-xs text-slate-500 font-medium uppercase tracking-wide">{{ 'DASHBOARD.TABLE.QUANTITY' | translate }}</p>
                  <p class="text-foreground font-semibold">{{ item.quantity }}</p>
                </div>
                <div>
                  <p class="text-xs text-slate-500 font-medium uppercase tracking-wide">{{ 'DASHBOARD.TABLE.PRICE' | translate }}</p>
                  @if (item.price) {
                    <p class="text-foreground font-semibold">{{ formatCurrency(item.price, item.currency) }}</p>
                  } @else {
                    <p class="text-slate-600">-</p>
                  }
                </div>
                <div>
                  <p class="text-xs text-slate-500 font-medium uppercase tracking-wide">{{ 'DASHBOARD.TABLE.STATUS' | translate }}</p>
                  <span
                    [ngClass]="{
                      'text-emerald-400 bg-emerald-950/50 border border-emerald-900': item.status === 'IN_STOCK',
                      'text-orange-400 bg-orange-950/50 border border-orange-900': item.status === 'LOW_STOCK',
                      'text-rose-400 bg-rose-950/50 border border-rose-900': item.status === 'OUT_OF_STOCK'
                    }"
                    class="px-3 py-1 rounded-md text-xs font-medium inline-block mt-1">
                    {{ getStatusKey(item.status) | translate }}
                  </span>
                </div>
              </div>

              <div class="flex justify-end gap-2 pt-3 border-t border-theme">
                <button
                  (click)="viewItem(item)"
                  class="p-2 hover:bg-[#2a2a2a] rounded-lg transition-colors">
                  <mat-icon class="!text-slate-500 !text-base !leading-none !block">visibility</mat-icon>
                </button>
                <button
                  (click)="editItem(item)"
                  class="p-2 hover:bg-[#2a2a2a] rounded-lg transition-colors">
                  <mat-icon class="!text-slate-500 !text-base !leading-none !block">edit</mat-icon>
                </button>
                <button
                  (click)="deleteItem(item)"
                  class="p-2 hover:bg-rose-950/20 rounded-lg transition-colors">
                  <mat-icon class="!text-rose-500 !text-base !leading-none !block">delete</mat-icon>
                </button>
              </div>
            </div>
          }
        </div>
      }
    </div>

    <!-- Quick Actions -->
    <div class="mt-6 flex flex-wrap gap-4">
      <button
        (click)="addNewItem()"
        class="bg-[#4d7c6f] text-white px-6 py-2 rounded-lg hover:bg-[#5d8c7f] transition-all font-medium">
        {{ 'DASHBOARD.ADD_NEW_ITEM' | translate }}
      </button>
      <button
        (click)="viewAllInventory()"
        class="bg-slate-800 text-foreground px-6 py-2 rounded-lg hover:bg-slate-700 transition-all font-medium">
        {{ 'COMMON.VIEW_ALL' | translate }} {{ 'NAV.INVENTORY' | translate }}
      </button>
    </div>
  </div>
</div>
