<aside
  class="sidebar"
  [class.collapsed]="isCollapsed()">

  <!-- Header with Logo and Toggle -->
  <div class="sidebar-header">
    @if (!isCollapsed()) {
      <div class="logo-section">
        <div class="logo-icon">
          <mat-icon>inventory_2</mat-icon>
        </div>
        <span class="logo-text">InvApp</span>
      </div>
    }
    <button
      class="toggle-btn"
      (click)="toggleSidebar($event)">
      <mat-icon>{{ isCollapsed() ? 'chevron_right' : 'chevron_left' }}</mat-icon>
    </button>
  </div>

  <!-- Navigation -->
  <nav class="sidebar-nav">
    <!-- Dashboard -->
    <a
      routerLink="/dashboard"
      routerLinkActive="active-link"
      class="nav-link"
      [matTooltip]="isCollapsed() ? ('NAV.DASHBOARD' | translate) : ''"
      matTooltipPosition="right">
      <div class="nav-icon-container">
        <mat-icon class="nav-icon">dashboard</mat-icon>
      </div>
      @if (!isCollapsed()) {
        <span class="nav-text">{{ 'NAV.DASHBOARD' | translate }}</span>
      }
    </a>

    <!-- Inventario Group -->
    @if (!isCollapsed()) {
      <div class="nav-group-label">
        {{ 'NAV.INVENTORY' | translate }}
      </div>
    } @else {
      <div class="nav-divider"></div>
    }

    <a
      routerLink="/inventory"
      routerLinkActive="active-link"
      class="nav-link"
      [matTooltip]="isCollapsed() ? ('NAV.INVENTORY' | translate) : ''"
      matTooltipPosition="right">
      <div class="nav-icon-container">
        <mat-icon class="nav-icon">inventory_2</mat-icon>
      </div>
      @if (!isCollapsed()) {
        <span class="nav-text">{{ 'NAV.INVENTORY' | translate }}</span>
      }
    </a>

    <a
      routerLink="/warehouses"
      routerLinkActive="active-link"
      class="nav-link"
      [matTooltip]="isCollapsed() ? ('NAV.WAREHOUSES' | translate) : ''"
      matTooltipPosition="right">
      <div class="nav-icon-container">
        <mat-icon class="nav-icon">warehouse</mat-icon>
      </div>
      @if (!isCollapsed()) {
        <span class="nav-text">{{ 'NAV.WAREHOUSES' | translate }}</span>
      }
    </a>

    <a
      routerLink="/categories"
      routerLinkActive="active-link"
      class="nav-link"
      [matTooltip]="isCollapsed() ? ('NAV.CATEGORIES' | translate) : ''"
      matTooltipPosition="right">
      <div class="nav-icon-container">
        <mat-icon class="nav-icon">category</mat-icon>
      </div>
      @if (!isCollapsed()) {
        <span class="nav-text">{{ 'NAV.CATEGORIES' | translate }}</span>
      }
    </a>

    <a
      routerLink="/suppliers"
      routerLinkActive="active-link"
      class="nav-link"
      [matTooltip]="isCollapsed() ? ('NAV.SUPPLIERS' | translate) : ''"
      matTooltipPosition="right">
      <div class="nav-icon-container">
        <mat-icon class="nav-icon">local_shipping</mat-icon>
      </div>
      @if (!isCollapsed()) {
        <span class="nav-text">{{ 'NAV.SUPPLIERS' | translate }}</span>
      }
    </a>

    <!-- Transactions with Submenu -->
    <div class="nav-item-with-submenu">
      <button
        class="nav-link nav-parent"
        [class.expanded]="isTransactionsExpanded()"
        [class.active-parent]="isTransactionsActive()"
        (click)="toggleTransactions()"
        [matTooltip]="isCollapsed() ? ('NAV.TRANSACTIONS' | translate) : ''"
        matTooltipPosition="right">
        <div class="nav-icon-container">
          <mat-icon class="nav-icon">receipt_long</mat-icon>
        </div>
        @if (!isCollapsed()) {
          <span class="nav-text">{{ 'NAV.TRANSACTIONS' | translate }}</span>
          <mat-icon class="expand-icon">{{ isTransactionsExpanded() ? 'expand_less' : 'expand_more' }}</mat-icon>
        }
      </button>

      @if (!isCollapsed() && isTransactionsExpanded()) {
        <div class="submenu">
          <a
            routerLink="/transactions"
            routerLinkActive="active-link"
            [routerLinkActiveOptions]="{ exact: true }"
            class="nav-link submenu-link">
            <mat-icon class="submenu-icon">list</mat-icon>
            <span class="nav-text">{{ 'NAV.TRANSACTIONS_LIST' | translate }}</span>
          </a>
          <a
            routerLink="/reports"
            routerLinkActive="active-link"
            class="nav-link submenu-link">
            <mat-icon class="submenu-icon">assessment</mat-icon>
            <span class="nav-text">{{ 'NAV.REPORTS' | translate }}</span>
          </a>
        </div>
      }
    </div>

    <!-- AdministraciÃ³n Group -->
    @if (!isCollapsed()) {
      <div class="nav-group-label">
        {{ 'NAV.ADMIN' | translate }}
      </div>
    } @else {
      <div class="nav-divider"></div>
    }

    <a
      routerLink="/users"
      routerLinkActive="active-link"
      class="nav-link"
      [matTooltip]="isCollapsed() ? ('NAV.USERS' | translate) : ''"
      matTooltipPosition="right">
      <div class="nav-icon-container">
        <mat-icon class="nav-icon">people</mat-icon>
      </div>
      @if (!isCollapsed()) {
        <span class="nav-text">{{ 'NAV.USERS' | translate }}</span>
      }
    </a>

    <a
      routerLink="/settings"
      routerLinkActive="active-link"
      class="nav-link"
      [matTooltip]="isCollapsed() ? ('NAV.SETTINGS' | translate) : ''"
      matTooltipPosition="right">
      <div class="nav-icon-container">
        <mat-icon class="nav-icon">settings</mat-icon>
      </div>
      @if (!isCollapsed()) {
        <span class="nav-text">{{ 'NAV.SETTINGS' | translate }}</span>
      }
    </a>

    <a
      routerLink="/profile"
      routerLinkActive="active-link"
      class="nav-link"
      [matTooltip]="isCollapsed() ? ('NAV.PROFILE' | translate) : ''"
      matTooltipPosition="right">
      <div class="nav-icon-container">
        <mat-icon class="nav-icon">account_circle</mat-icon>
      </div>
      @if (!isCollapsed()) {
        <span class="nav-text">{{ 'NAV.PROFILE' | translate }}</span>
      }
    </a>
  </nav>

  <!-- Footer -->
  <div class="sidebar-footer">
    @if (currentUser(); as user) {
      <div class="user-info" [class.collapsed]="isCollapsed()">
        <div class="user-avatar"
             [matTooltip]="isCollapsed() ? user.name || user.email : ''"
             matTooltipPosition="right">
          <span>{{ (user.name || user.email || 'U').charAt(0).toUpperCase() }}</span>
        </div>
        @if (!isCollapsed()) {
          <div class="user-details">
            <p class="user-name">{{ user.name || ('COMMON.USER' | translate) }}</p>
            <p class="user-email">{{ user.email }}</p>
          </div>
        }
      </div>
    }

    @if (!isCollapsed()) {
      <div class="language-selector-wrapper">
        <app-language-selector></app-language-selector>
      </div>
    }
  </div>
</aside>
